import airflow
import unidecode
import pandas as pd
import numpy as np
import datetime

from datetime import timedelta, date
from dateutil import rrule
from airflow import DAG
from airflow.operators.python_operator import PythonOperator
from collections import OrderedDict as od
from queries.unimed_go.queries import *
from queries.unimed_go.queries_hdata import *
from queries.unimed_go.queries_complementar import *
from connections.oracle.connections import connect_ugo 

from utils.upsert_default import by_date_upsert
from utils.integrity_checker import notify_email
from utils.config import STAGE_NAMESPACE

START_DATE = airflow.utils.dates.days_ago(1)

default_args = {
    "owner": "lucas",
    "depends_on_past": False,
    "start_date": START_DATE,
    "email": ["lucas.freire@hdata.med.br"],
    "email_on_failure": False,
    "email_on_retry": False,
    "retries": 0,
    "retry_delay": timedelta(minutes=0),
    "provide_context": True,
}

dt_ontem = datetime.datetime.today() - datetime.timedelta(days=1)
dt_ini = datetime.datetime.today() - datetime.timedelta(days=15)
# dt_ini = datetime.datetime(2023,5,1)

def teste():
    query1 = '''SELECT NR_ATENDIMENTO, IE_TIPO_ATENDIMENTO, CD_ESTABELECIMENTO FROM TASY.ATENDIMENTO_PACIENTE WHERE NR_ATENDIMENTO IN (6715911,6715933,6716066,6716107,6716514,6716860,6716991,6717137,6717286,6717297,6717375,6717395,6717439,6717634,6717683,6717688,6717734,6717948,6717962,6718170,6718240,6718278,6718298,6718370,6718385,6718387,6718404,6718408,6718412,6718439,6718447,6718459,6718502,6718507,6718523,6718552,6718573,6718669,6718685,6718820,6719260,6719309,6719375,6719399,6719551,6719646,6719749,6719825,6719829,6719966,6719974,6720012,6720158,6720185,6720204,6720258,6720286,6720289,6720397,6720445,6720509,6720551,6720569,6720805,6720839,6720864,6720939,6720950,6720953,6720966,6720972,6720977,6720985,6721037,6721083,6721101,6721107,6721129,6721171,6721215,6721234,6721249,6721266,6721270,6721299,6721312,6721316,6721321,6721365,6721375,6721380,6721398,6721400,6721404,6721505,6721567,6722023,6722159,6722267,6722283,6722354,6722400,6722545,6722582,6722618,6722629,6722650,6722652,6722659,6722708,6722740,6722860,6722899,6723032,6723098,6723246,6723299,6723324,6723336,6723369,6723402,6723477,6723493,6723511,6723572,6723576,6723587,6723593,6723612,6723638,6723640,6723647,6723677,6723733,6723751,6723775,6723778,6723794,6723803,6723831,6723832,6723849,6723862,6723872,6723909,6724036,6724441,6724510,6724697,6724754,6724756,6724972,6725111,6725142,6725208,6725252,6725341,6725348,6725394,6725432,6725435,6725464,6725473,6725553,6725636,6725651,6725704,6725768,6725796,6725891,6725936,6725965,6725981,6725992,6725996,6726009,6726031,6726043,6726060,6726061,6726072,6726087,6726104,6726144,6726180,6726212,6726229,6726279,6726308,6726813,6727094,6727143,6727171,6727212,6727220,6727230,6727247,6727291,6727298,6727356,6727397,6727475,6727506,6727515,6727519,6727539,6727573,6727597,6727650,6727682,6727700,6727708,6727722,6727733,6727757,6727771,6727784,6727825,6727852,6727872,6727881,6727886,6727921,6727930,6727948,6728542,6728614,6728807,6728831,6728975,6729072,6729120,6729192,6729289,6729313,6729385,6729409,6729481,6729578,6729602,6729626,6729650,6729722,6729746,6729867,6729915,6729963,6730012,6730180,6730204,6730228,6730325,6730349,6730373,6730445,6730493,6730542,6730638,6730662,6730734,6730807,6730855,6730999,6731024,6731048,6731144,6731168,6731192,6731216,6731264,6731313,6731361,6731385,6731409,6731433,6731457,6731481,6731650,6731674,6731698,6731722,6731746,6731770,6731867,6731939,6731963,6731987,6732011,6732204,6732228,6732276,6732349,6732373,6732397,6732445,6732469,6732493,6732517,6732566,6732638,6732662,6732686,6732734,6732855,6732927,6733047,6733072,6733096,6733120,6733168,6733264,6733288,6733313,6733409,6733433,6733457,6733529,6733553,6733602,6733650,6733698,6733770,6733891,6733963,6733987,6734035,6734059,6734252,6734276,6734300,6734324,6734349,6734373,6734421,6734469,6734493,6734565,6734590,6734662,6734710,6734855,6734879,6734903,6734927,6734951,6734975,6735047,6735120,6735192,6735264,6735288,6735336,6735361,6735457,6735505,6735529,6735553,6735626,6735698,6735722,6735770,6735794,6735818,6735891,6735915,6735939,6735987,6736011,6736035,6736059,6736083,6736252,6736300,6736421,6736445,6736469,6736517,6736613,6736638,6736710,6736758,6736830,6736854,6736951,6737023,6737047,6737095,6737119,6737216,6737264,6737312,6737360,6737385,6737433,6737481,6737577,6737601,6737650,6737698,6737746,6737818,6737866,6737915,6737939,6737963,6738011,6738059,6738107,6738252,6738445,6738565,6738613,6738686,6738734,6738830,6738902,6738927,6738999,6739047,6739095,6739119,6739168,6739216,6739240,6739288,6739312,6739360,6739384,6739408,6739433,6739457,6739481,6739529,6739625,6739649,6739674,6739722,6739794,6739842,6739890,6739939,6740011,6740083,6740107,6740155,6740180,6740204,6740300,6740348,6740372,6740420,6740493,6740685,6740710,6740854,6740951,6740999,6741071,6741167,6741191,6741264,6741288,6741360,6741457,6741481,6741505,6741529,6741601,6741625,6741746,6741794,6741842,6741890,6742059,6742083,6742107,6742203,6742228,6742252,6742324,6742372,6742420,6742517,6742541,6742613,6742685,6742734,6742878,6742902,6742926,6743023,6743047,6743071,6743095,6743143,6743191,6743240,6743264,6743288,6743312,6743336,6743360,6743529,6743553,6743577,6743601,6743625,6743649,6743746,6743818,6743842,6743866,6743890,6744083,6744107,6744155,6744227,6744252,6744276,6744324,6744348,6744372,6744396,6744444,6744517,6744541,6744565,6744613,6744733,6744806,6744926,6744950,6744974,6744998,6745047,6745143,6745167,6745191,6745288,6745312,6745336,6745408,6745432,6745480,6745529,6745577,6745649,6745769,6745842,6745866,6745914,6745938,6746131,6746155,6746179,6746203,6746227,6746251,6746300,6746348,6746372,6746444,6746468,6746541,6746589,6746733,6746757,6746781,6746806,6746830,6746854,6746926,6746998,6747071,6747143,6747167,6747215,6747239,6747336,6747384,6747408,6747432,6747504,6747577,6747601,6747649,6747673,6747697,6747769,6747793,6747818,6747866,6747890,6747914,6747938,6747962,6748131,6748179,6748299,6748324,6748348,6748396,6748492,6748516,6748589,6748637,6748709,6748733,6748830,6748902,6748926,6748974,6748998,6749095,6749143,6749191,6749239,6749263,6749311,6749360,6749456,6749480,6749528,6749576,6749625,6749697,6749745,6749793,6749817,6749841,6749890,6749938,6749986,6750131,6750323,6750444,6750492,6750564,6750613,6750709,6750781,6750805,6750878,6750926,6750974,6750998,6751046,6751094,6751119,6751167,6751191,6751239,6751263,6751287,6751311,6751335,6751359,6751408,6751504,6751528,6751552,6751600,6751673,6751721,6751769,6751817,6751890,6751962,6751986,6752034,6752058,6752082,6752179,6752227,6752251,6752299,6752371,6752564,6752588,6752733,6752829,6752877,6752950,6753046,6753070,6753142,6753167,6753239,6753335,6753359,6753383,6753408,6753480,6753504,6753624,6753673,6753721,6753769,6753938,6753962,6753986,6754082,6754106,6754130,6754203,6754251,6754299,6754395,6754419,6754492,6754564,6754612,6754757,6754781,6754805,6754901,6754925,6754950,6754974,6755022,6755070,6755118,6755142,6755166,6755191,6755215,6755239,6755407,6755431,6755456,6755480,6755504,6755528,6755624,6755696,6755721,6755745,6755769,6755962,6755986,6756034,6756106,6756130,6756154,6756202,6756227,6756251,6756275,6756323,6756395,6756419,6756443,6756492,6756612,6756684,6756805,6756829,6756853,6756877,6756925,6757022,6757046,6757070,6757166,6757190,6757214,6757287,6757311,6757359,6757407,6757455,6757528,6757648,6757720,6757745,6757793,6757817,6758010,6758034,6758058,6758082,6758106,6758130,6758178,6758226,6758251,6758323,6758347,6758419,6758467,6758612,6758636,6758660,6758684,6758708,6758732,6758805,6758877,6758949,6759022,6759046,6759094,6759118,6759214,6759263,6759287,6759311,6759383,6759455,6759479,6759528,6759552,6759576,6759648,6759672,6759696,6759744,6759769,6759793,6759817,6759841,6760009,6760058,6760178,6760202,6760226,6760274,6760371,6760395,6760467,6760515,6760588,6760612,6760708,6760780,6760805,6760853,6760877,6760973,6761021,6761070,6761118,6761142,6761190,6761238,6761335,6761359,6761407,6761455,6761503,6761576,6761624,6761672,6761696,6761720,6761768,6761817,6761865,6762009,6762202,6762323,6762371,6762443,6762491,6762588,6762660,6762684,6762756,6762804,6762853,6762877,6762925,6762973,6762997,6763045,6763069,6763118,6763142,6763166,6763190,6763214,6763238,6763286,6763383,6763407,6763431,6763479,6763551,6763600,6763648,6763696,6763768,6763841,6763865,6763913,6763937,6763961,6764057,6764106,6764130,6764178,6764250,6764443,6764467,6764612,6764708,6764756,6764828,6764925,6764949,6765021,6765045,6765118,6765214,6765238,6765262,6765286,6765358,6765383,6765503,6765551,6765599,6765648,6765816,6765840,6765864,6765961,6765985,6766009,6766081,6766130,6766178,6766274,6766298,6766370,6766443,6766491,6766635,6766660,6766684,6766780,6766804,6766828,6766852,6766901,6766949,6766997,6767021,6767045,6767069,6767093,6767117,6767286,6767310,6767334,6767358,6767382,6767407,6767503,6767575,6767599,6767623,6767647,6767840,6767864,6767913,6767985,6768009,6768033,6768081,6768105,6768129,6768153,6768202,6768274,6768298,6768322,6768370,6768491,6768563,6768684,6768708,6768732,6768756,6768804,6768900,6768924,6768949,6769045,6769069,6769093,6769165,6769190,6769238,6769286,6769334,6769406,6769527,6769599)'''
    query2 = '''SELECT NR_ATENDIMENTO, IE_TIPO_ATENDIMENTO, CD_ESTABELECIMENTO FROM TASY.ATENDIMENTO_PACIENTE WHERE NR_ATENDIMENTO IN (6769623,6769671,6769696,6769888,6769912,6769936,6769961,6769985,6770009,6770057,6770105,6770129,6770202,6770226,6770298,6770346,6770491,6770515,6770539,6770563,6770587,6770611,6770683,6770756,6770828,6770900,6770924,6770973,6770997,6771093,6771141,6771165,6771189,6771262,6771334,6771358,6771406,6771430,6771454,6771527,6771551,6771575,6771623,6771647,6771671,6771695,6771719,6771888,6771936,6772057,6772081,6772105,6772153,6772250,6772274,6772346,6772394,6772466,6772491,6772587,6772659,6772683,6772731,6772756,6772852,6772900,6772948,6772996,6773021,6773069,6773117,6773213,6773237,6773286,6773334,6773382,6773454,6773502,6773551,6773575,6773599,6773647,6773695,6773743,6773888,6774081,6774201,6774249,6774322,6774370,6774466,6774539,6774563,6774635,6774683,6774731,6774755,6774804,6774852,6774876,6774924,6774948,6774996,6775020,6775045,6775069,6775093,6775117,6775165,6775261,6775285,6775310,6775358,6775430,6775478,6775526,6775575,6775647,6775719,6775743,6775791,6775816,6775840,6775936,6775984,6776008,6776057,6776129,6776322,6776346,6776490,6776587,6776635,6776707,6776803,6776828,6776900,6776924,6776996,6777093,6777117,6777141,6777165,6777237,6777261,6777382,6777430,6777478,6777526,6777695,6777719,6777743,6777840,6777864,6777888,6777960,6778008,6778056,6778153,6778177,6778249,6778321,6778370,6778514,6778538,6778562,6778659,6778683,6778707,6778731,6778779,6778827,6778876,6778900,6778924,6778948,6778972,6778996,6779165,6779189,6779213,6779237,6779261,6779285,6779382,6779454,6779478,6779502,6779526,6779719,6779743,6779791,6779863,6779888,6779912,6779960,6779984,6780008,6780032,6780080,6780153,6780177,6780201,6780249,6780369,6780442,6780562,6780586,6780610,6780635,6780683,6780779,6780803,6780827,6780924,6780948,6780972,6781044,6781068,6781116,6781165,6781213,6781285,6781406,6781478,6781502,6781550,6781574,6781767,6781791,6781815,6781839,6781863,6781887,6781936,6781984,6782008,6782080,6782104,6782177,6782225,6782369,6782393,6782418,6782442,6782466,6782490,6782562,6782634,6782707,6782779,6782803,6782851,6782875,6782972,6783020,6783044,6783068,6783140,6783213,6783237,6783285,6783309,6783333,6783405,6783430,6783454,6783502,6783526,6783550,6783574,6783598,6783767,6783815,6783935,6783960,6783984,6784032,6784128,6784152,6784225,6784273,6784345,6784369,6784466,6784538,6784562,6784610,6784634,6784731,6784779,6784827,6784875,6784899,6784947,6784996,6785092,6785116,6785164,6785213,6785261,6785333,6785381,6785429,6785453,6785478,6785526,6785574,6785622,6785767,6785959,6786080,6786128,6786200,6786249,6786345,6786417,6786441,6786514,6786562,6786610,6786634,6786682,6786730,6786755,6786803,6786827,6786875,6786899,6786923,6786947,6786971,6786996,6787044,6787140,6787164,6787188,6787236,6787309,6787357,6787405,6787453,6787526,6787598,6787622,6787670,6787694,6787718,6787815,6787863,6787887,6787935,6788007,6788200,6788224,6788369,6788465,6788513,6788586,6788682,6788706,6788779,6788803,6788875,6788971,6788995,6789019,6789044,6789116,6789140,6789260,6789309,6789357,6789405,6789574,6789598,6789622,6789718,6789742,6789766,6789839,6789887,6789935,6790031,6790056,6790128,6790200,6790248,6790393,6790417,6790441,6790537,6790562,6790586,6790610,6790658,6790706,6790754,6790778,6790802,6790827,6790851,6790875,6791043,6791068,6791092,6791116,6791140,6791164,6791260,6791333,6791357,6791381,6791405,6791598,6791622,6791670,6791742,6791766,6791790,6791839,6791863,6791887,6791911,6791959,6792031,6792055,6792080,6792128,6792248,6792320,6792441,6792465,6792489,6792513,6792561,6792658,6792682,6792706,6792802,6792826,6792851,6792923,6792947,6792995,6793043,6793091,6793164,6793284,6793357,6793381,6793429,6793453,6793646,6793670,6793694,6793718,6793742,6793766,6793814,6793863,6793887,6793959,6793983,6794055,6794103,6794248,6794272,6794296,6794320,6794344,6794369,6794441,6794513,6794585,6794658,6794682,6794730,6794754,6794850,6794899,6794923,6794947,6795019,6795091,6795115,6795164,6795188,6795212,6795284,6795308,6795332,6795380,6795405,6795429,6795453,6795477,6795646,6795694,6795814,6795838,6795862,6795911,6796007,6796031,6796103,6796152,6796224,6796248,6796344,6796417,6796441,6796489,6796513,6796609,6796657,6796706,6796754,6796778,6796826,6796874,6796971,6796995,6797043,6797091,6797139,6797212,6797260,6797308,6797332,6797356,6797404,6797453,6797501,6797645,6797838,6797959,6798007,6798079,6798127,6798224,6798296,6798320,6798392,6798441,6798489,6798513,6798561,6798609,6798633,6798681,6798706,6798754,6798778,6798802,6798826,6798850,6798874,6798922,6799019,6799043,6799067,6799115,6799187,6799236,6799284,6799332,6799404,6799477,6799501,6799549,6799573,6799597,6799693,6799742,6799766,6799814,6799886,6800079,6800103,6800248,6800344,6800392,6800464,6800561,6800585,6800657,6800681,6800754,6800850,6800874,6800898,6800922,6800995,6801019,6801139,6801187,6801235,6801284,6801452,6801476,6801501,6801597,6801621,6801645,6801717,6801766,6801814,6801910,6801934,6802007,6802079,6802127,6802272,6802296,6802320,6802416,6802440,6802464,6802488,6802537,6802585,6802633,6802657,6802681,6802705,6802729,6802753,6802922,6802946,6802970,6802994,6803019,6803043,6803139,6803211,6803235,6803259,6803284,6803476,6803500,6803549,6803621,6803645,6803669,6803717,6803741,6803765,6803790,6803838,6803910,6803934,6803958,6804006,6804127,6804199,6804320,6804344,6804368,6804392,6804440,6804536,6804561,6804585,6804681,6804705,6804729,6804802,6804826,6804874,6804922,6804970,6805042,6805163,6805235,6805259,6805307,6805332,6805524,6805548,6805573,6805597,6805621,6805645,6805693,6805741,6805765,6805838,6805862,6805934,6805982,6806127,6806151,6806175,6806199,6806223,6806247,6806319,6806392,6806464,6806536,6806560,6806609,6806633,6806729,6806777,6806801,6806825,6806898,6806970,6806994,6807042,6807066,6807091,6807163,6807187,6807211,6807259,6807283,6807307,6807331,6807356,6807524,6807572,6807693,6807717,6807741,6807789,6807886,6807910,6807982,6808030,6808102,6808127,6808223,6808295,6808319,6808368,6808392,6808488,6808536,6808584,6808633,6808657,6808705,6808753,6808849,6808874,6808922,6808970,6809018,6809090,6809139,6809187,6809211,6809235,6809283,6809331,6809380,6809524,6809717,6809837,6809885,6809958,6810006,6810102,6810175,6810199,6810271,6810319,6810367,6810391,6810440,6810488,6810512,6810560,6810584,6810632,6810657,6810681,6810705,6810729,6810753,6810801,6810897,6810922,6810946,6810994,6811066,6811114,6811163,6811211,6811283,6811355,6811379,6811428,6811452,6811476,6811572,6811620,6811644,6811693,6811765,6811958,6811982,6812126,6812223,6812271,6812343,6812440,6812464,6812536,6812560,6812632,6812729,6812753,6812777,6812801,6812873,6812897,6813018,6813066,6813114,6813162,6813331,6813355,6813379,6813476,6813500,6813524,6813596,6813644,6813692,6813789,6813813,6813885,6813957,6814006,6814150,6814174,6814198,6814295,6814319,6814343,6814367,6814415,6814463,6814512,6814536,6814560,6814584,6814608,6814632,6814801,6814825,6814849,6814873,6814897,6814921,6815018,6815090,6815114,6815138,6815162,6815355,6815379,6815427,6815500,6815524,6815548,6815596,6815620,6815644,6815668,6815716,6815789,6815813,6815837,6815885,6816006,6816078,6816198,6816222,6816246,6816271,6816319,6816415,6816439,6816463,6816560,6816584,6816608,6816680,6816704,6816752,6816801,6816849,6816921,6817042,6817114,6817138,6817186,6817210,6817403,6817427,6817451,6817475,6817499,6817524,6817572,6817620,6817644,6817716,6817740,6817813,6817861,6818005,6818030,6818054,6818078,6818102,6818126,6818198,6818270,6818343,6818415,6818439,6818487,6818511,6818608,6818656,6818680,6818704,6818776,6818849,6818873,6818921,6818945,6818969,6819041,6819066,6819090,6819138,6819162,6819186,6819210,6819234,6819403,6819451,6819572,6819596,6819620,6819668,6819764,6819788,6819861,6819909,6819981,6820005,6820102,6820174,6820198,6820246,6820270,6820367,6820415,6820463,6820511,6820535,6820584,6820632,6820728,6820752,6820800,6820849,6820897,6820969,6821017,6821065,6821090,6821114,6821162,6821210,6821258,6821403,6821596,6821716,6821764,6821836,6821885,6821981,6822053,6822077,6822150,6822198,6822246,6822270,6822318,6822367)'''
    query3 = '''SELECT NR_ATENDIMENTO, IE_TIPO_ATENDIMENTO, CD_ESTABELECIMENTO FROM TASY.ATENDIMENTO_PACIENTE WHERE NR_ATENDIMENTO IN (6822391,6822439,6822463,6822511,6822535,6822559,6822583,6822607,6822632,6822680,6822776,6822800,6822824,6822873,6822945,6822993,6823041,6823089,6823162,6823234,6823258,6823306,6823330,6823354,6823451,6823499,6823523,6823571,6823644,6823836,6823860,6824005,6824101,6824150,6824222,6824318,6824342,6824415,6824439,6824511,6824607,6824631,6824656,6824680,6824752,6824776,6824896,6824945,6824993,6825041,6825210,6825234,6825258,6825354,6825378,6825402,6825475,6825523,6825571,6825668,6825692,6825764,6825836,6825884,6826029,6826053,6826077,6826174,6826198,6826222,6826246,6826294,6826342,6826390,6826414,6826439,6826463,6826487,6826511,6792883,6792922,6792973,6793009,6793041,6793053,6793062,6793067,6793190,6793210,6793296,6793311,6793316,6793326,6793365,6793367,6793399,6793476,6793514,6793592,6793654,6793752,6793762,6793931,6793957,6793975,6794010,6794056,6794058,6794070,6794077,6794084,6794109,6794132,6794156,6794164,6794192,6794215,6794230,6794235,6794241,6794251,6715918,6715923,6715964,6715969,6715985,6715990,6715997,6716000,6716006,6716122,6716240,6716268,6716335,6716361,6716671,6716786,6716800,6716958,6717039,6717084,6717148,6717150,6717243,6717330,6717369,6717413,6717424,6717498,6717572,6717610,6717871,6717922,6717988,6718036,6718124,6718135,6718201,6718266,6718282,6718303,6718313,6718343,6718345,6718347,6718361,6718393,6718399,6718401,6718422,6718425,6718446,6718453,6718470,6718482,6718489,6718511,6718512,6718540,6718545,6718555,6718580,6718589,6718591,6718601,6718628,6718976,6719189,6719203,6719497,6719583,6719716,6720032,6720043,6720060,6720075,6720117,6720148,6720322,6720340,6720378,6720406,6720436,6720572,6720586,6720605,6720662,6720706,6720725,6720755,6720851,6720894,6720899,6720959,6721031,6721054,6721058,6721125,6721133,6721136,6721152,6721160,6721200,6721208,6721222,6721226,6721229,6721232,6721293,6721301,6721307,6721310,6721326,6721348,6721357,6721392,6721394,6721402,6721456,6721531,6721887,6721973,6722047,6722052,6722111,6722137,6722180,6722197,6722353,6722409,6722424,6722427,6722456,6722485,6722492,6722518,6722653,6722694,6722807,6722848,6722905,6722968,6723089,6723112,6723153,6723169,6723179,6723206,6723423,6723433,6723482,6723490,6723499,6723506,6723534,6723535,6723581,6723601,6723604,6723609,6723628,6723649,6723654,6723709,6723721,6723770,6723798,6723801,6723838,6724113,6724213,6724271,6724296,6724365,6724408,6724472,6724563,6724576,6724623,6724635,6724826,6725012,6725061,6725096,6725188,6725202,6725225,6725258,6725316,6725361,6725375,6725386,6725403,6725413,6725456,6725489,6725493,6725504,6725577,6725637,6725685,6725787,6725835,6725902,6725905,6725919,6725969,6725984,6725994,6725999,6726002,6726012,6726040,6726070,6726080,6726092,6726109,6726110,6726119,6726124,6726132,6726149,6726151,6726154,6726159,6726166,6726171,6726174,6726186,6726190,6726206,6726208,6726227,6726242,6726259,6726305,6726322,6726378,6726487,6726824,6726841,6727156,6727165,6727193,6727214,6727235,6727258,6727350,6727413,6727592,6727618,6727627,6727638,6727701,6727713,6727717,6727730,6727746,6727758,6727777,6727781,6727805,6727815,6727856,6727903,6727906,6727912,6727926,6727952,6728566,6728590,6728638,6728662,6728686,6728710,6728735,6728759,6728783,6728855,6728879,6728903,6728927,6728951,6729000,6729024,6729048,6729096,6729144,6729168,6729216,6729241,6729265,6729337,6729361,6729433,6729457,6729506,6729530,6729554,6729674,6729698,6729771,6729795,6729819,6729843,6729891,6729939,6729987,6730036,6730060,6730084,6730108,6730132,6730156,6730252,6730277,6730301,6730397,6730421,6730469,6730518,6730566,6730590,6730614,6730686,6730710,6730758,6730783,6730831,6730879,6730903,6730927,6730951,6730975,6731072,6731096,6731120,6731240,6731289,6731337,6731505,6731530,6731554,6731578,6731602,6731626,6731795,6731819,6731843,6731891,6731915,6732035,6732060,6732084,6732108,6732132,6732156,6732180,6732252,6732301,6732325,6732421,6732541,6732590,6732614,6732710,6732758,6732782,6732807,6732831,6732879,6732903,6732951,6732975,6732999,6733023,6733144,6733192,6733216,6733240,6733337,6733361,6733385,6733481,6733505,6733578,6733626,6733674,6733722,6733746,6733794,6733819,6733843,6733867,6733915,6733939,6734011,6734084,6734108,6734132,6734156,6734180,6734204,6734228,6734397,6734445,6734517,6734541,6734614,6734638,6734686,6734734,6734758,6734782,6734806,6734830,6734999,6735023,6735071,6735096,6735144,6735168,6735216,6735240,6735312,6735385,6735409,6735433,6735481,6735577,6735602,6735650,6735674,6735746,6735842,6735867,6735963,6736108,6736132,6736156,6736180,6736204,6736228,6736276,6736324,6736348,6736373,6736397,6736493,6736541,6736565,6736589,6736662,6736686,6736734,6736782,6736806,6736879,6736903,6736927,6736975,6736999,6737071,6737144,6737168,6737192,6737240,6737288,6737336,6737409,6737457,6737505,6737529,6737553,6737625,6737674,6737722,6737770,6737794,6737842,6737891,6737987,6738035,6738083,6738131,6738156,6738180,6738204,6738228,6738276,6738300,6738324,6738348,6738372,6738396,6738421,6738469,6738493,6738517,6738541,6738589,6738637,6738662,6738710,6738758,6738782,6738806,6738854,6738878,6738951,6738975,6739023,6739071,6739143,6739192,6739264,6739336,6739505,6739553,6739577,6739601,6739698,6739746,6739770,6739818,6739866,6739914,6739963,6739987,6740035,6740059,6740131,6740228,6740252,6740276,6740324,6740396,6740445,6740469,6740517,6740541,6740565,6740589,6740613,6740637,6740661,6740734,6740758,6740782,6740806,6740830,6740878,6740902,6740926,6740975,6741023,6741047,6741095,6741119,6741143,6741216,6741240,6741312,6741336,6741384,6741408,6741432,6741553,6741577,6741649,6741673,6741697,6741722,6741770,6741818,6741866,6741914,6741938,6741963,6741987,6742011,6742035,6742131,6742155,6742179,6742276,6742300,6742348,6742396,6742444,6742469,6742493,6742565,6742589,6742637,6742661,6742709,6742758,6742782,6742806,6742830,6742854,6742950,6742974,6742999,6743119,6743167,6743215,6743384,6743408,6743432,6743456,6743480,6743505,6743673,6743697,6743721,6743770,6743794,6743914,6743938,6743962,6743986,6744011,6744035,6744059,6744131,6744179,6744203,6744300,6744420,6744468,6744492,6744589,6744637,6744661,6744685,6744709,6744758,6744782,6744830,6744854,6744878,6744902,6745023,6745071,6745095,6745119,6745215,6745239,6745263,6745360,6745384,6745456,6745504,6745553,6745601,6745625,6745673,6745697,6745721,6745745,6745794,6745818,6745890,6745962,6745986,6746010,6746035,6746059,6746083,6746107,6746275,6746324,6746396,6746420,6746492,6746516,6746565,6746613,6746637,6746661,6746685,6746709,6746878,6746902,6746950,6746974,6747022,6747046,6747095,6747119,6747191,6747263,6747287,6747312,6747360,6747456,6747480,6747528,6747552,6747625,6747721,6747745,6747842,6747986,6748010,6748034,6748058,6748083,6748107,6748155,6748203,6748227,6748251,6748275,6748372,6748420,6748444,6748468,6748540,6748564,6748613,6748661,6748685,6748757,6748781,6748805,6748854,6748878,6748950,6749022,6749046,6749070,6749119,6749167,6749215,6749287,6749335,6749384,6749408,6749432,6749504,6749552,6749601,6749649,6749673,6749721,6749769,6749866,6749914,6749962,6750010,6750034,6750058,6750082,6750107,6750155,6750179,6750203,6750227,6750251,6750275,6750299,6750347,6750372,6750396,6750420,6750468,6750516,6750540,6750588,6750637,6750661,6750685,6750733,6750757,6750829,6750853,6750902,6750950,6751022,6751070,6751143,6751215,6751384,6751432,6751456,6751480,6751576,6751624,6751649,6751697,6751745,6751793,6751841,6751865,6751914,6751938,6752010,6752106,6752130,6752155,6752203,6752275,6752323,6752347,6752396,6752420,6752444,6752468,6752492,6752516,6752540,6752612,6752636,6752661,6752685,6752709,6752757,6752781,6752805,6752853,6752902,6752926,6752974,6752998,6753022,6753094,6753118,6753191,6753215,6753263,6753287,6753311,6753432,6753456,6753528,6753552,6753576,6753600,6753648,6753697,6753745,6753793,6753817,6753841,6753865,6753889,6753913,6754010,6754034,6754058,6754154,6754179,6754227,6754275,6754323,6754347,6754371,6754444,6754468,6754516,6754540,6754588,6754636,6754660,6754685,6754709,6754733,6754829,6754853,6754877,6754998,6755046,6755094,6755263,6755287,6755311)'''
    query4 = '''SELECT NR_ATENDIMENTO, IE_TIPO_ATENDIMENTO, CD_ESTABELECIMENTO FROM TASY.ATENDIMENTO_PACIENTE WHERE NR_ATENDIMENTO IN (6755335,6755359,6755383,6755552,6755576,6755600,6755648,6755672,6755793,6755817,6755841,6755865,6755889,6755913,6755937,6756010,6756058,6756082,6756178,6756299,6756347,6756371,6756468,6756516,6756540,6756564,6756588,6756636,6756660,6756708,6756733,6756757,6756781,6756901,6756949,6756974,6756998,6757094,6757118,6757142,6757239,6757263,6757335,6757383,6757431,6757480,6757504,6757552,6757576,6757600,6757624,6757672,6757696,6757769,6757841,6757865,6757889,6757913,6757937,6757961,6757985,6758154,6758202,6758275,6758299,6758371,6758395,6758443,6758491,6758516,6758540,6758564,6758588,6758757,6758781,6758829,6758853,6758901,6758925,6758973,6758997,6759070,6759142,6759166,6759190,6759238,6759335,6759359,6759407,6759431,6759503,6759600,6759624,6759720,6759865,6759889,6759913,6759937,6759961,6759985,6760034,6760082,6760106,6760130,6760154,6760250,6760299,6760323,6760347,6760419,6760443,6760491,6760540,6760564,6760636,6760660,6760684,6760732,6760756,6760829,6760901,6760925,6760949,6760997,6761046,6761094,6761166,6761214,6761262,6761286,6761311,6761383,6761431,6761479,6761527,6761552,6761600,6761648,6761744,6761792,6761841,6761889,6761913,6761937,6761961,6761985,6762033,6762058,6762082,6762106,6762130,6762154,6762178,6762226,6762250,6762274,6762298,6762347,6762395,6762419,6762467,6762515,6762539,6762563,6762612,6762636,6762708,6762732,6762780,6762829,6762901,6762949,6763021,6763094,6763262,6763310,6763335,6763359,6763455,6763503,6763527,6763575,6763624,6763672,6763720,6763744,6763792,6763816,6763889,6763985,6764009,6764033,6764081,6764154,6764202,6764226,6764274,6764298,6764322,6764346,6764371,6764395,6764419,6764491,6764515,6764539,6764563,6764587,6764636,6764660,6764684,6764732,6764780,6764804,6764852,6764877,6764901,6764973,6764997,6765069,6765093,6765142,6765166,6765190,6765310,6765334,6765407,6765431,6765455,6765479,6765527,6765575,6765624,6765672,6765696,6765720,6765744,6765768,6765792,6765889,6765913,6765937,6766033,6766057,6766105,6766154,6766202,6766226,6766250,6766322,6766346,6766395,6766419,6766467,6766515,6766539,6766563,6766587,6766611,6766708,6766732,6766756,6766876,6766925,6766973,6767141,6767166,6767190,6767214,6767238,6767262,6767431,6767455,6767479,6767527,6767551,6767672,6767696,6767720,6767744,6767768,6767792,6767816,6767888,6767937,6767961,6768057,6768178,6768226,6768250,6768346,6768394,6768419,6768443,6768467,6768515,6768539,6768587,6768611,6768635,6768659,6768780,6768828,6768852,6768876,6768973,6768997,6769021,6769117,6769141,6769214,6769262,6769310,6769358,6769382,6769430,6769455,6769479,6769503,6769551,6769575,6769647,6769720,6769744,6769768,6769792,6769816,6769840,6769864,6770033,6770081,6770153,6770177,6770250,6770274,6770322,6770370,6770394,6770418,6770442,6770467,6770635,6770659,6770708,6770732,6770780,6770804,6770852,6770876,6770948,6771021,6771045,6771069,6771117,6771213,6771238,6771286,6771310,6771382,6771479,6771503,6771599,6771744,6771768,6771792,6771816,6771840,6771864,6771912,6771960,6771985,6772009,6772033,6772129,6772177,6772201,6772225,6772298,6772322,6772370,6772418,6772442,6772515,6772539,6772563,6772611,6772635,6772707,6772780,6772804,6772828,6772876,6772924,6772972,6773045,6773093,6773141,6773165,6773189,6773262,6773310,6773358,6773406,6773430,6773478,6773527,6773623,6773671,6773719,6773768,6773792,6773816,6773840,6773864,6773912,6773936,6773960,6773984,6774008,6774033,6774057,6774105,6774129,6774153,6774177,6774225,6774274,6774298,6774346,6774394,6774418,6774442,6774490,6774514,6774587,6774611,6774659,6774707,6774780,6774828,6774900,6774972,6775141,6775189,6775213,6775237,6775334,6775382,6775406,6775454,6775502,6775551,6775599,6775623,6775671,6775695,6775767,6775864,6775888,6775912,6775960,6776032,6776081,6776105,6776153,6776177,6776201,6776225,6776249,6776273,6776297,6776370,6776394,6776418,6776442,6776466,6776514,6776538,6776563,6776611,6776659,6776683,6776731,6776755,6776779,6776852,6776876,6776948,6776972,6777020,6777044,6777069,6777189,6777213,6777285,6777309,6777334,6777358,6777406,6777454,6777502,6777550,6777574,6777599,6777623,6777647,6777671,6777767,6777791,6777815,6777912,6777936,6777984,6778032,6778080,6778105,6778129,6778201,6778225,6778273,6778297,6778346,6778394,6778418,6778442,6778466,6778490,6778586,6778611,6778635,6778755,6778803,6778852,6779020,6779044,6779068,6779092,6779117,6779141,6779309,6779333,6779357,6779406,6779430,6779550,6779574,6779598,6779623,6779647,6779671,6779695,6779767,6779815,6779839,6779936,6780056,6780104,6780129,6780225,6780273,6780297,6780321,6780345,6780394,6780418,6780466,6780490,6780514,6780538,6780659,6780707,6780731,6780755,6780851,6780875,6780900,6780996,6781020,6781092,6781141,6781189,6781237,6781261,6781309,6781333,6781357,6781381,6781430,6781454,6781526,6781598,6781622,6781646,6781671,6781695,6781719,6781743,6781912,6781960,6782032,6782056,6782128,6782152,6782201,6782249,6782273,6782297,6782321,6782345,6782514,6782538,6782586,6782610,6782658,6782683,6782731,6782755,6782827,6782899,6782924,6782948,6782996,6783092,6783116,6783164,6783189,6783261,6783357,6783381,6783478,6783622,6783646,6783670,6783695,6783719,6783743,6783791,6783839,6783863,6783887,6783911,6784008,6784056,6784080,6784104,6784176,6784201,6784249,6784297,6784321,6784393,6784417,6784441,6784490,6784514,6784586,6784658,6784682,6784707,6784755,6784803,6784851,6784923,6784972,6785020,6785044,6785068,6785140,6785188,6785237,6785285,6785309,6785357,6785405,6785502,6785550,6785598,6785646,6785670,6785694,6785719,6785743,6785791,6785815,6785839,6785863,6785887,6785911,6785935,6785984,6786008,6786032,6786056,6786104,6786152,6786176,6786224,6786273,6786297,6786321,6786369,6786393,6786465,6786490,6786538,6786586,6786658,6786706,6786779,6786851,6787020,6787068,6787092,6787116,6787212,6787261,6787285,6787333,6787381,6787429,6787477,6787502,6787550,6787574,6787646,6787742,6787767,6787791,6787839,6787911,6787959,6787983,6788032,6788056,6788080,6788104,6788128,6788152,6788176,6788248,6788273,6788297,6788321,6788345,6788393,6788417,6788441,6788489,6788538,6788562,6788610,6788634,6788658,6788730,6788754,6788827,6788851,6788899,6788923,6788947,6789068,6789092,6789164,6789188,6789212,6789236,6789285,6789333,6789381,6789429,6789453,6789477,6789501,6789525,6789550,6789646,6789670,6789694,6789791,6789815,6789863,6789911,6789959,6789983,6790007,6790080,6790104,6790152,6790176,6790224,6790272,6790296,6790321,6790345,6790369,6790465,6790489,6790513,6790634,6790682,6790730,6790899,6790923,6790947,6790971,6790995,6791019,6791188,6791212,6791236,6791284,6791308,6791429,6791453,6791477,6791501,6791525,6791549,6791574,6791646,6791694,6791718,6791814,6791935,6791983,6792007,6792104,6792152,6792176,6792200,6792224,6792272,6792296,6792345,6792369,6792393,6792417,6792537,6792585,6792610,6792634,6792730,6792754,6792778,6792875,6792899,6792971,6793019,6793067,6793116,6793140,6793188,6793212,6793236,6793260,6793308,6793332,6793405,6793477,6793501,6793525,6793549,6793573,6793597,6793622,6793790,6793838,6793911,6793935,6794007,6794031,6794079,6794128,6794152,6794176,6794200,6794224,6794393,6794417,6794465,6794489,6794537,6794561,6794609,6794634,6794706,6794778,6794802,6794826,6794874,6794971,6794995,6795043,6795067,6795140,6795236,6795260,6795356,6795501,6795525,6795549,6795573,6795597,6795621,6795670,6795718,6795742,6795766,6795790,6795886,6795935,6795959,6795983,6796055,6796079,6796127,6796176,6796200,6796272,6796296,6796320,6796368,6796392,6796465,6796537,6796561,6796585,6796633,6796682,6796730,6796802,6796850,6796898,6796923,6796947,6797019,6797067,6797115,6797163,6797188,6797236,6797284,6797380,6797429,6797477,6797525,6797549,6797573,6797597,6797621,6797669,6797694,6797718,6797742,6797766,6797790,6797814,6797862,6797886,6797910,6797935,6797983,6798031,6798055,6798103,6798151,6798175,6798200,6798248,6798272,6798344,6798368,6798416,6798465,6798537,6798585,6798657,6798730,6798898,6798946,6798971,6798995,6799091,6799139,6799163,6799212,6799260,6799308,6799356,6799380,6799428,6799452,6799525,6799621,6799645,6799669,6799718,6799790,6799838)'''
    query5 = '''SELECT NR_ATENDIMENTO, IE_TIPO_ATENDIMENTO, CD_ESTABELECIMENTO FROM TASY.ATENDIMENTO_PACIENTE WHERE NR_ATENDIMENTO IN (6799862,6799910,6799934,6799958,6799983,6800007,6800031,6800055,6800127,6800151,6800175,6800199,6800224,6800272,6800296,6800320,6800368,6800416,6800440,6800489,6800513,6800537,6800609,6800633,6800705,6800730,6800778,6800802,6800826,6800946,6800970,6801043,6801067,6801091,6801115,6801163,6801211,6801260,6801308,6801332,6801356,6801380,6801404,6801428,6801525,6801549,6801573,6801669,6801693,6801741,6801790,6801838,6801862,6801886,6801958,6801982,6802031,6802055,6802103,6802151,6802175,6802199,6802223,6802247,6802344,6802368,6802392,6802513,6802561,6802609,6802778,6802802,6802826,6802850,6802874,6802898,6803067,6803091,6803115,6803163,6803187,6803308,6803332,6803356,6803380,6803404,6803428,6803452,6803524,6803573,6803597,6803693,6803814,6803862,6803886,6803982,6804030,6804055,6804079,6804103,6804151,6804175,6804223,6804247,6804271,6804296,6804416,6804464,6804488,6804512,6804609,6804633,6804657,6804753,6804777,6804850,6804898,6804946,6804994,6805018,6805067,6805091,6805115,6805139,6805187,6805211,6805283,6805356,6805380,6805404,6805428,6805452,6805476,6805500,6805669,6805717,6805789,6805813,6805886,6805910,6805958,6806006,6806030,6806054,6806079,6806103,6806271,6806295,6806344,6806368,6806416,6806440,6806488,6806512,6806585,6806657,6806681,6806705,6806753,6806850,6806874,6806922,6806946,6807018,6807115,6807139,6807235,6807380,6807404,6807428,6807452,6807476,6807500,6807548,6807596,6807621,6807645,6807669,6807765,6807813,6807837,6807862,6807934,6807958,6808006,6808054,6808078,6808151,6808175,6808199,6808247,6808271,6808343,6808416,6808440,6808464,6808512,6808560,6808608,6808681,6808729,6808777,6808801,6808825,6808898,6808946,6808994,6809042,6809066,6809114,6809163,6809259,6809307,6809355,6809404,6809428,6809452,6809476,6809500,6809548,6809572,6809596,6809620,6809645,6809669,6809693,6809741,6809765,6809789,6809813,6809861,6809910,6809934,6809982,6810030,6810054,6810078,6810126,6810151,6810223,6810247,6810295,6810343,6810416,6810464,6810536,6810608,6810777,6810825,6810849,6810873,6810970,6811018,6811042,6811090,6811138,6811187,6811235,6811259,6811307,6811331,6811403,6811500,6811524,6811548,6811596,6811669,6811717,6811741,6811789,6811813,6811837,6811861,6811885,6811909,6811934,6812006,6812030,6812054,6812078,6812102,6812150,6812174,6812199,6812247,6812295,6812319,6812367,6812391,6812415,6812488,6812512,6812584,6812608,6812656,6812680,6812705,6812825,6812849,6812921,6812946,6812970,6812994,6813042,6813090,6813138,6813186,6813211,6813235,6813259,6813283,6813307,6813403,6813427,6813452,6813548,6813572,6813620,6813668,6813717,6813741,6813765,6813837,6813861,6813909,6813933,6813982,6814030,6814054,6814078,6814102,6814126,6814223,6814247,6814271,6814391,6814439,6814488,6814656,6814680,6814704,6814729,6814753,6814777,6814945,6814969,6814994,6815042,6815066,6815186,6815210,6815235,6815259,6815283,6815307,6815331,6815403,6815451,6815475,6815572,6815692,6815741,6815765,6815861,6815909,6815933,6815957,6815981,6816030,6816054,6816102,6816126,6816150,6816174,6816295,6816343,6816367,6816391,6816487,6816512,6816536,6816632,6816656,6816728,6816777,6816825,6816873,6816897,6816945,6816969,6816993,6817018,6817066,6817090,6817162,6817234,6817258,6817283,6817307,6817331,6817355,6817379,6817548,6817596,6817668,6817692,6817764,6817789,6817837,6817885,6817909,6817933,6817957,6817981,6818150,6818174,6818222,6818246,6818295,6818319,6818367,6818391,6818463,6818535,6818560,6818584,6818632,6818728,6818752,6818801,6818825,6818897,6818993,6819017,6819114,6819258,6819282,6819307,6819331,6819355,6819379,6819427,6819475,6819499,6819523,6819547,6819644,6819692,6819716,6819740,6819813,6819837,6819885,6819933,6819957,6820029,6820053,6820078,6820126,6820150,6820222,6820294,6820318,6820343,6820391,6820439,6820487,6820559,6820608,6820656,6820680,6820704,6820776,6820824,6820873,6820921,6820945,6820993,6821041,6821138,6821186,6821234,6821282,6821306,6821330,6821355,6821379,6821427,6821451,6821475,6821499,6821523,6821547,6821571,6821620,6821644,6821668,6821692,6821740,6821788,6821812,6821861,6821909,6821933,6821957,6822005,6822029,6822102,6822126,6822174,6822222,6822294,6822342,6822415,6822487,6822656,6822704,6822728,6822752,6822848,6822897,6822921,6822969,6823017,6823065,6823113,6823138,6823186,6823210,6823282,6823379,6823403,6823427,6823475,6823547,6823595,6823619,6823668,6823692,6823716,6823740,6823764,6823788,6823812,6823885,6823909,6823933,6823957,6823981,6824029,6824053,6824077,6824125,6824174,6824198,6824246,6824270,6824294,6824366,6824391,6824463,6824487,6824535,6824559,6824583,6824704,6824728,6824800,6824824,6824848,6824872,6824921,6824969,6825017,6825065,6825089,6825113,6825137,6825162,6825186,6825282,6825306,6825330,6825427,6825451,6825499,6825547,6825595,6825619,6825643,6825716,6825740,6825788,6825812,6825860,6825908,6825933,6825957,6825981,6826005,6826101,6826125,6826149,6826270,6826318,6826366,6826535,6792911,6792935,6792956,6792987,6793003,6793035,6793119,6793281,6793330,6793351,6793388,6793436,6793481,6793497,6793508,6793528,6793583,6793590,6793604,6793620,6793621,6793690,6793797,6793803,6793825,6793865,6793876,6793884,6793889,6793908,6793913,6793949,6793964,6793993,6793997,6794015,6794027,6794053,6794079,6794140,6794159,6794196,6794198,6794204,6794232)'''

    df = pd.read_sql(query1,connect_ugo())
    print(df.to_string())
    df = pd.read_sql(query2,connect_ugo())
    print(df.to_string())
    df = pd.read_sql(query3,connect_ugo())
    print(df.to_string())
    df = pd.read_sql(query4,connect_ugo())
    print(df.to_string())
    df = pd.read_sql(query5,connect_ugo())
    print(df.to_string())

dag = DAG("captura_dados_complementar_unimed", default_args=default_args, schedule_interval=None)

t0 = PythonOperator(
    task_id="upsert_evolucao_paciente",
    python_callable=teste,
    on_failure_callback=notify_email,
    dag=dag)

t0